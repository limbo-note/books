### URI格式
- 绝对URI：  
http://user:passwd@www.example.jp:8080/dir/index.htm?uid=1#ch1

URL是URI的子集

# 2. HTTP
请求报文：请求方法、请求URI、协议版本、请求首部字段、内容实体  

响应报文：协议版本、状态码、解释状态码的原因短语、响应首部字段、实体主体

GET:获取资源（从服务器获取）  
POST：传输实体主体（发送给服务器）  
PUT：传输文件（发送给服务器）  
HEAD：获得报文首部，与GET一样，只是不返回报文主体  
DELETE：删除文件，与PUT相反  
OPTIONS：询问服务器所支持的上述方法  
TRACE、CONNECT  

### 持久连接
HTTP 协议的初始版本中， 每进行一次 HTTP 通信就要断开一次 TCP 连接，为解决过多TCP连接的问题，提出了持久连接：只要任意一端没有明确提出断开连接， 则保持 TCP 连接状态。

在 HTTP/1.1 中， 所有的连接默认都是持久连接。

### 管线化
从前发送请求后需等待并收到响应，才能发送下一个请求。 管线化技术出现后，不用等待响应亦可直接发送下一个请求。  

### COOKIE
HTTP是不保存状态（无状态）协议，为了实现保持状态功能，引入Cookie

Cookie技术通过在请求和响应报文中写入Cookie信息来控制客户端的状态。从服务器端发送的响应报文内的一个叫做 Set-Cookie 的首部字段信息，通知客户端保存 Cookie。 当下次客户端再往该服务器发送请求时， 客户端会自动在请求报文中加入 Cookie 值后发送出去。

服务器端发现客户端发送过来的 Cookie 后，会去检查究竟是从哪一个客户端发来的连接请求，然后对比服务器上的记录，最后得到之前的状态信息

# 3. HTTP报文
报文首部、报文主体（不一定有报文主体）

请求报文：请求行（包括方法、URI、HTTP版本）、首部字段  
响应报文：状态行（包括HTTP版本、状态码、原因）、首部字段

通常，报文主体等于实体主体。 只有当传输中进行编码操作时，实体主体的内容发生变化，才导致它和报文主体产生差异。（gzip, compress,deflate,identity)  

范围请求：指定请求资源的某个范围内的字节  

# 4. 状态码  
RCF 定义：
- 1XX： 信息性状态码。接受的请求正在处理
- 2XX：成功状态码。 请求正常处理完毕
	- 200 OK，请求被正常处理
	- 204 No Content，请求被成功处理，但没有主体部分可返回
	- 206 Partial Content，成功执行并响应了范围请求
- 3XX：重定向状态码。需要进行附加操作
	- 301 Moved Permanently，请求的资源被分配了新的URI
	- 302 Found，请求的资源被临时分配了新的URI
	- 303 See Other，类似302
	- 304 Not Modified，找到资源，但不满足条件。响应中不包含主体， 与重定向无关
- 4XX：客户端错误。
	-  400 Bad Request，请求报文中存在语法错误
	-  401 Unauthorzed，HTTP认证
	-  403 Forbidden，请求资源的访问被服务器拒绝
	-  404 Not Found，无法找到请求的资源
- 5XX：服务器端错误
	- 500 Internal Server Error，服务器执行请求时发生错误，bug
	- 503 Service Unavailable，服务器超负载或停机维护

# 5. web服务器

### 5.1 单台服务器实现多个域名

利用虚拟主机：即使物理层面只有一台服务器，但只要使用虚拟主机的功能，则可以假想已具有多台服务器。

### 5.2 代理、网关、隧道
**代理**：接收由客户端发送的请求并转发给服务器，同时也接收源服务器返回的响应并转发给客户端

- 缓存代理：预先将资源的副本（缓存）保存在代理服务器上，再次收到请求时，直接返回
- 透明代理：转发时不对报文做加工，为透明代理；反之，非透明

**网关**：网关的工作机制和代理十分相似。 而网关能使通信线路上的服务器提供非 HTTP协议服务，提高安全性

**隧道**：确保客户端能与服务器进行安全的通信。可以和远距离的服务器通信

# 6. HTTP首部
首部字段：通用首部字段、请求首部字段、响应首部字段、实体首部字段、Cookie首部字段、其它

# 7. HTTPS
HTTP缺点：
- 明文，被窃听（解决：结合SSL加密通信，称为**HTTPS**-> 不同于只加密通信的主体内容）
- 身份验证，可伪装（解决：SSL也提供了证书机制，确认通信方）
- 报文完整性，被篡改（解决：MD5，SHA-1散列值校验，数字签名，SSL）

HTTPS: HTTP+加密+认证+完整性保护

HTTPS中演变成HTTP先和SSL通信，再由SSL和TCP通信，而不是HTTP直接和TCP通信  

### 相互交换密钥的公开密钥加密技术
SSL：算法公开，密钥保密

共享（对称）密钥加密：加解密用同一个密钥  
公开（非对称）密钥加密：两把密钥，一把私有，另一把公开。发送密文的一方使用对方的公开密钥进行加密处理，对方收到被加密的信息后，再使用自己的私有密钥进行解密。 利用这种方式，不需要发送用来解密的私有密钥，也不必担心密钥被攻击者窃听而盗走。

HTTPS混合采用上述两种加密机制

### 公开密钥证书
首先，服务器的运营人员向数字证书认证机构提出公开密钥的申请。 数字证书认证
机构在判明提出申请者的身份之后，会对已申请的公开密钥做数字签名，然后分配这个已签名的公开密钥，并将该公开密钥放入公钥证书后绑定在一起。服务器会将这份由数字证书认证机构颁发的公钥证书发送给客户端，以进行公开密钥加密方式通信。公钥证书也叫（**数字证书、证书**）

**P150，图解，重要**

服务端证书、客户端证书

自认证机构颁发的服务器证书之所以不起作用，是因为它无法消除伪装的可能性。应由值得信赖的第三方机构介入。

### HTTPS 通信步骤
P154

HTTPS比HTTP慢2-100倍，更消耗CPU、内存、网络资源

# 8. 确认访问用户身份的认证
认证：
- 密码
- 动态令牌：物理设备内一次性密码
- 数字证书：终端持有的信息
- 生物认证
- IC卡：本人持有的信息

HTTP认证：
- BASIC认证（基本认证）
- DIGEST认证（摘要认证）
- SSL客户端认证
- FormBase认证（基于表单认证）

### BASIC认证
WWW-Authenticate/ Authorization首部字段

不常用

### DIGEST认证
WWW-Authenticate/ Authorization首部字段

BASIC升级版，但安全性仍旧弱，不常用

### SSL客户端认证
认证步骤：
- 客户端证书分发给客户端，客户端安装
- 收到请求后，服务器发送Certificate Request报文，要求提供证书
- 客户端以Certificate Request报文形式将证书信息发送至服务端
- 认证通过，获取证书内客户端的公钥，加密通信

通常**双因素认证**：和基于表单认证一起使用，安全性更高

### 基于表单认证
认证大部分为基于表单认证（即输入账号密码），比BASIC/DIGEST安全性高，比SSL客户端认证更便利

session,cookie管理状态

# 9/10/11 忽略